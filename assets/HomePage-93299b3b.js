import{d as x,o as r,c as y,a as m,u as $,s as C,r as t,b as w,w as o,e as p,f as n,g,h as P,i as F,j as R,F as B,k as j,l as N}from"./index-f9c5c501.js";import{u as S,_ as U}from"./VideoPlayer.vue_vue_type_style_index_0_lang-c7070b59.js";const z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},O=m("path",{d:"M80 152v256a40.12 40.12 0 0 0 40 40h272a40.12 40.12 0 0 0 40-40V152",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),L=m("rect",{x:"48",y:"64",width:"416",height:"80",rx:"28",ry:"28",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),M=m("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M320 304l-64 64l-64-64"},null,-1),A=m("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 345.89V224"},null,-1),H=[O,L,M,A],I=x({name:"ArchiveOutline",render:function(_,l){return r(),y("svg",z,H)}}),D={class:"home-page__upload"},E={style:{"margin-bottom":"12px"}},G=x({__name:"UploadFile",setup(b){const _=$(),{fetchStatus:l,videoId:c}=C(S()),{uploadVideo:i,checkVideoStatus:a}=S(),d=async h=>{const e=await i(h);if(e!=null&&e.id){const s=await a(e.id);(s==null?void 0:s.status)==="error"&&(s==null?void 0:s.code)===500&&(_.error({content:"Что-то пошло не так",duration:3e3}),c.value=null)}(e==null?void 0:e.status)==="error"&&_.error({content:"Что-то пошло не так",duration:3e3})};return(h,e)=>{const s=t("n-spin"),f=t("n-icon"),v=t("n-text"),k=t("n-p"),u=t("n-upload-dragger"),T=t("n-upload"),V=t("n-card");return r(),w(V,null,{default:o(()=>[m("div",D,[p(l)==="loading"?(r(),w(s,{key:0,size:"large",style:{width:"100%"}})):(r(),w(T,{key:1,"directory-dnd":"","on-change":d,"show-file-list":!1,accept:"video/mp4"},{default:o(()=>[n(u,null,{default:o(()=>[m("div",E,[n(f,{size:"48",depth:3,component:p(I)},null,8,["component"])]),n(v,{style:{"font-size":"16px"}},{default:o(()=>[g(" Кликните или перетащите файл ")]),_:1}),n(k,{depth:"3",style:{margin:"8px 0 0 0"}},{default:o(()=>[g(" Доступный формат: .mp4 ")]),_:1}),n(k,{depth:"3",style:{margin:"8px 0 0 0"}},{default:o(()=>[g(" Максимальный размер: 250 МБ ")]),_:1})]),_:1})]),_:1}))])]),_:1})}}}),q=["src"],J=x({__name:"RTSPLink",setup(b){const{theme:_}=C(P()),l={color:"#FFFFFF"},c={color:"#333333"},i=F(null),a=F(null),d=()=>{i.value=`https://89.232.165.248.sslip.io/api/v1/ml/rl?url_rtsp=${a.value}`};return(h,e)=>{const s=t("n-input"),f=t("n-button"),v=t("n-card"),k=t("n-modal");return r(),y(B,null,[n(v,null,{default:o(()=>[n(s,{value:a.value,"onUpdate:value":e[0]||(e[0]=u=>a.value=u),placeholder:"Введите ссылку на RTSP поток","theme-overrides":p(_)===null?l:c},null,8,["value","theme-overrides"]),n(f,{type:"primary",style:{width:"100%","margin-top":"1rem"},onClick:d},{default:o(()=>[g("Отправить")]),_:1})]),_:1}),n(k,{show:i.value,"onUpdate:show":e[1]||(e[1]=u=>i.value=u),preset:"card",style:{width:"fit-content","min-width":"40vw"},onClose:e[2]||(e[2]=u=>a.value=null)},{default:o(()=>[i.value?(r(),y("img",{key:0,style:{"max-width":"40vw","min-height":"40vh",width:"100%",height:"100%"},src:i.value,alt:"stream"},null,8,q)):R("",!0)]),_:1},8,["show"])],64)}}}),K={class:"home-page"},X=x({__name:"HomePage",setup(b){const{fetchStatus:_,videoId:l,videoPath:c}=C(S());return j(()=>{l.value=null,c.value=null}),(i,a)=>{const d=t("n-tab-pane"),h=t("n-tabs"),e=t("n-spin"),s=t("n-result"),f=t("n-modal");return r(),y("div",K,[n(h,{type:"segment"},{default:o(()=>[n(d,{name:"video",tab:"Видео"},{default:o(()=>[n(G)]),_:1}),n(d,{name:"link",tab:"RTSP поток"},{default:o(()=>[n(J)]),_:1})]),_:1}),n(f,{show:p(l),"onUpdate:show":a[0]||(a[0]=v=>N(l)?l.value=v:null),preset:"card",style:{width:"fit-content","min-width":"50vw"}},{default:o(()=>[p(c)?(r(),w(U,{key:0,path:p(c)},null,8,["path"])):(r(),w(s,{key:1,status:"info",title:"Подождите, видео обрабатывается"},{footer:o(()=>[n(e,{size:"large"})]),_:1}))]),_:1},8,["show"])])}}});export{X as default};
